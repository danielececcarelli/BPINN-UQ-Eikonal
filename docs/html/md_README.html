<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>My Project: BPINN for Inverse Eikonal</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">My Project
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">BPINN for Inverse Eikonal </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="autotoc_md1"></a>
Bayesian Physics-Informed Neural Networks for Uncertainty Quantification in Inverse Eikonal problem</h1>
<h1><a class="anchor" id="autotoc_md2"></a>
Intro</h1>
<p>A Bayesian implementation of Physics-Informed Neural Network to solve the Inverse Problem (identification of the fields of conduction velocity tensor) in Eikonal (isotropic or anisotropic) equation. Thanks to the bayesian framework we can also use noisy data as input and estimate the Uncertainty of our result (Uncertainty Quantification problem).</p>
<h1><a class="anchor" id="autotoc_md3"></a>
Run</h1>
<p>How to run the code:</p>
<h2><a class="anchor" id="autotoc_md4"></a>
1) choose a method for Bayesian PINN</h2>
<p>Methods available:</p>
<ul>
<li>HMC (Hamiltonian Monte Carlo), one the classical MCMC algorithm to sample from posterior</li>
<li>SVGD (Stein Variational Gradient Descent), a finite method that approximate the posterior through N finite particles</li>
</ul>
<h2><a class="anchor" id="autotoc_md5"></a>
2) run</h2>
<p>You have to specify at least (mandatory!) the method you want to use.</p>
<p>(run on CPU):</p>
<ul>
<li>CUDA_VISIBLE_DEVICES="" python mainsolve.py &ndash;method HMC</li>
<li>CUDA_VISIBLE_DEVICES="" python mainsolve.py &ndash;method SVGD</li>
</ul>
<p>(run on GPU):</p>
<ul>
<li>python mainsolve.py &ndash;method HMC</li>
<li>python mainsolve.py &ndash;method SVGD</li>
</ul>
<h2><a class="anchor" id="autotoc_md6"></a>
3) parameters</h2>
<p>You can specify in a json file all the parameters you are going to use in the code. You can find some example in "config" subfolder (for instance all the experiment reported in the report.pdf) and a "default.json", that is the default choice if you don't provide any config file. If you want to specify your own json file you can:</p><ul>
<li>make a copy of the "default.json", rename it as "yourname.json" and put it in the "config" subfolder</li>
<li>modify your "yourname.json" in an appropriate way (you will have a dictionary for both "HMC" and "SVGD" parameters inside your file, you can delete the one you are not going to use if you want...)</li>
<li>run with the additional arguments &ndash;config yourname.json, for instance:</li>
</ul>
<p>python mainsolve.py &ndash;method SVGD &ndash;config yourname.json</p>
<p>In "utils/args.py" you can find also an arg parser for additional parameters provided by command-line. You can overspecify some parameters directly from command-line without the need of create a new json file for just a small change. This can be useful when you want to test the algorithm with a fixed set of parameters and varying just one, for instance:</p>
<p>python mainsolve.py &ndash;method SVGD &ndash;config default.json (where n_samples is set to 30 in default.json file) python mainsolve.py &ndash;method SVGD &ndash;config default.json &ndash;n_samples 20 (now we are setting n_samples to 20) python mainsolve.py &ndash;method SVGD &ndash;config default.json &ndash;n_samples 40 (now we are setting n_samples to 40)</p>
<h2><a class="anchor" id="autotoc_md7"></a>
4) config, dataset and experiment available</h2>
<p>The parameter you can specify in a json file are: { "architecture":{"n_layers":5, "n_neurons":100},</p>
<p>"experiment":{"dataset":"exponential", "prop_exact":0.01, "prop_collocation":1.00, "is_uniform_exact":"False", "noise_lv":0.01, "batch_size":100},</p>
<p>"param":{ "param_eikonal":0.1, "param_log_joint":2.0, "param_prior":1.0, "param2loss":1e-4, "random_seed":42 },</p>
<p>"sigmas":{ "data_prior_noise":1e-4, "pde_prior_noise":1e-4, "data_prior_noise_trainable":"False", "pde_prior_noise_trainable":"False" },</p>
<p>"SVGD":{ "n_samples":30, "epochs":100, "lr":1e-3, "lr_noise":1e-5, "param_repulsivity":100.0 },</p>
<p>"HMC":{ "N_HMC":1000, "M_HMC":750, "L_HMC":10, "dt_HMC":1e-3 },</p>
<p>"utils":{ "verbose":"True", "save_flag":"True", "save_every_n_epochs":0 } }</p>
<p>In architecture you can specify the structure of the Feed Forward Neural Network (num of layer and num of neurons for each layer) In experiment you can choose which dataset you want to use, how many points do you want to use as exact data and collocation data etc. In param you can specify some weights for the Bayesian computation of the posterior (and a param for penalizing high gradients of velocity) In sigmas you can provide additional parameter if you want to make sigmas trainable hyperparameter In "SVGD" and "HMC" you can specify the parameters for the selected method In "utils" some other flag for verbosity and saving result</p>
<p>You can select some different datasets, some of them built using the analytical solution of the Eikonal equation, some other collected using Pykonal library, a python library to solve the Forward Eikonal isotropic problem.</p>
<p>You can choose between:</p><ul>
<li>"exponential": 1D, isotropic, analytical</li>
<li>"circle": 2D, isotropic, analytical</li>
<li>"triflag": 2D, isotropic, pykonal_dataset</li>
<li>"square_with_circle": 2D, isotropic, pykonal_dataset</li>
<li>"anisotropic1": 2D, anisotropic, analytical</li>
<li>"anisotropic2": 2D, anisotropic, analytical</li>
<li>"prova3D": 3D, isotropic, pykonal_dataset</li>
<li>"prolate3D": 3D, isotropic, pykonal_dataset</li>
<li>"prolate3D_scar_new_version": 3D, isotropic, pykonal_dataset</li>
<li>"prolate3D_new_version": 3D isotropic, pykonal_dataset</li>
</ul>
<p>You will find all the result in the correct subfolder:</p><ul>
<li>1D-isotropic-eikonal</li>
<li>2D-anisotropic-eikonal</li>
<li>2D-isotropic-eikonal</li>
<li>3D-isotropic-eikonal </li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.0
</small></address>
</body>
</html>
